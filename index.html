<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jessica & Christoph ‚Äì 20.06.2026</title>
  <style>
    body {
      background: #ffffff;
      color: #1e1e1e;
      font-family: 'Georgia', serif;
      text-align: center;
      padding: 2rem;
    }
    h1 {
      font-size: 2.8rem;
      color: #2a4d2a;
      margin-bottom: 0.2rem;
    }
    h2 {
      font-style: italic;
      color: #000;
      margin-bottom: 2rem;
    }
    select, button {
      font-size: 1rem;
      padding: 0.5rem 1rem;
      margin: 0.5rem;
      border-radius: 6px;
      border: 2px solid #2a4d2a;
      background: white;
      color: #2a4d2a;
      cursor: pointer;
    }
    button {
      background: #2a4d2a;
      color: white;
      border: none;
    }
    button:hover {
      background: #1e3d1e;
    }
    video, img {
      display: block;
      margin: 1rem auto;
      max-width: 90vw;
      border: 3px solid #2a4d2a;
      border-radius: 10px;
    }
    #message {
      margin-top: 1rem;
      font-weight: bold;
      color: #2a4d2a;
    }
  </style>
</head>
<body>
  <h1>Jessica & Christoph</h1>
  <h2>20.06.2026</h2>

  <video id="video" autoplay playsinline style="display:none;"></video>
  <img id="photo" style="display:none;" alt="Vorschau"/>
  <div id="message"></div>
  
  <label for="cameraSelect">Kamera w√§hlen:</label>
  <select id="cameraSelect"></select><br/>

  <button id="startBtn">Kamera starten</button>
  <div>
    <button id="frontBtn">Frontkamera</button>
    <button id="backBtn">R√ºckkamera</button>
  </div>
  <button id="snapBtn" disabled>üì∏ Foto machen</button>
  <button id="uploadBtn" disabled>‚¨ÜÔ∏è Hochladen</button>

  <script>
    const cameraSelect = document.getElementById('cameraSelect'),
          startBtn = document.getElementById('startBtn'),
          snapBtn  = document.getElementById('snapBtn'),
          uploadBtn= document.getElementById('uploadBtn'),
          video    = document.getElementById('video'),
          photo    = document.getElementById('photo'),
          message  = document.getElementById('message');
    let stream, blob;

    const DROPBOX_ACCESS_TOKEN = 'HIER_DEIN_DROPBOX_ACCESS_TOKEN';

    async function listCameras() {
      const devices = await navigator.mediaDevices.enumerateDevices();
      devices.filter(d => d.kind === 'videoinput').forEach((d, i) => {
        const o = document.createElement('option');
        o.value = d.deviceId;
        o.text = d.label || `Kamera ${i + 1}`;
        cameraSelect.append(o);
      });
    }

    async function startCamera() {
      if (stream) stream.getTracks().forEach(t => t.stop());
      try {
        stream = await navigator.mediaDevices.getUserMedia({
          video: { deviceId: cameraSelect.value }
        });
        video.srcObject = stream;
        video.style.display = 'block';
        snapBtn.disabled = false;
        message.textContent = '';
      } catch {
        message.textContent = 'Kamera-Zugriff fehlgeschlagen';
      }
    }

    snapBtn.onclick = () => {
      const c = document.createElement('canvas');
      c.width = video.videoWidth;
      c.height = video.videoHeight;
      c.getContext('2d').drawImage(video, 0, 0);
      c.toBlob(b => {
        blob = b;
        photo.src = URL.createObjectURL(b);
        photo.style.display = 'block';
        uploadBtn.disabled = false;
      }, 'image/jpeg', 0.9);
      video.style.display = 'none';
    };

    uploadBtn.onclick = async () => {
      if (!blob) return;
      message.textContent = 'Lade hoch‚Ä¶';
      const name = `JessicaChristoph_${Date.now()}.jpg`;
      try {
        const res = await fetch('https://content.dropboxapi.com/2/files/upload', {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${DROPBOX_ACCESS_TOKEN}`,
            'Dropbox-API-Arg': JSON.stringify({
              path: '/' + name,
              mode: 'add',
              autorename: true,
              mute: false
            }),
            'Content-Type': 'application/octet-stream'
          },
          body: blob
        });
        if (!res.ok) throw '';
        message.textContent = 'Upload erfolgreich üéâ';
        uploadBtn.disabled = true;
      } catch {
        message.textContent = 'Upload fehlgeschlagen';
      }
    };

    cameraSelect.onchange = startCamera;
    startBtn.onclick = startCamera;
    listCameras();
  </script>
</body>
</html>
